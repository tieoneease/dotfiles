-- Auto-generated by matugen via Noctalia. Do not edit.
require('base16-colorscheme').setup({
    base00 = "{{colors.surface.default.hex}}",
    base01 = "{{colors.surface_container.default.hex}}",
    base02 = "{{colors.surface_container_high.default.hex}}",
    base03 = "{{colors.outline.default.hex}}",
    base04 = "{{colors.on_surface_variant.default.hex}}",
    base05 = "{{colors.on_surface.default.hex}}",
    base06 = "{{colors.on_surface.default.hex | lighten: 5.0}}",
    base07 = "{{colors.on_surface.default.hex | lighten: 10.0}}",
    base08 = "{{colors.error.default.hex}}",
    base09 = "{{colors.tertiary.default.hex | lighten: -10.0}}",
    base0A = "{{colors.secondary.default.hex | lighten: 5.0}}",
    base0B = "{{colors.primary.default.hex | lighten: -10.0}}",
    base0C = "{{colors.secondary.default.hex}}",
    base0D = "{{colors.primary.default.hex}}",
    base0E = "{{colors.tertiary.default.hex}}",
    base0F = "{{colors.error.default.hex | lighten: -15.0}}",
})

-- Highlight overrides (layered on top of base16 — additive, removable)
-- Editor groups
vim.api.nvim_set_hl(0, "Visual", { bg = "{{colors.primary_container.default.hex}}", fg = "{{colors.on_primary_container.default.hex}}" })
vim.api.nvim_set_hl(0, "Comment", { fg = "{{colors.outline.default.hex}}", italic = true })
vim.api.nvim_set_hl(0, "CursorLine", { bg = "{{colors.surface_container_low.default.hex}}" })
vim.api.nvim_set_hl(0, "ColorColumn", { bg = "{{colors.surface_container_low.default.hex}}" })

-- Standard vim groups (covers non-Treesitter files too)
vim.api.nvim_set_hl(0, "String", { fg = "{{colors.green.default.hex}}" })
vim.api.nvim_set_hl(0, "Number", { fg = "{{colors.orange.default.hex}}" })
vim.api.nvim_set_hl(0, "Boolean", { fg = "{{colors.orange.default.hex}}" })
vim.api.nvim_set_hl(0, "Float", { fg = "{{colors.orange.default.hex}}" })
vim.api.nvim_set_hl(0, "Type", { fg = "{{colors.yellow.default.hex}}" })
vim.api.nvim_set_hl(0, "Conditional", { italic = true })

-- Treesitter groups (override base16's links for Treesitter-parsed files)
vim.api.nvim_set_hl(0, "@string", { fg = "{{colors.green.default.hex}}" })
vim.api.nvim_set_hl(0, "@number", { fg = "{{colors.orange.default.hex}}" })
vim.api.nvim_set_hl(0, "@boolean", { fg = "{{colors.orange.default.hex}}" })
vim.api.nvim_set_hl(0, "@number.float", { fg = "{{colors.orange.default.hex}}" })
vim.api.nvim_set_hl(0, "@type", { fg = "{{colors.yellow.default.hex}}" })
vim.api.nvim_set_hl(0, "@type.builtin", { fg = "{{colors.yellow.default.hex}}", bold = true })
vim.api.nvim_set_hl(0, "@function.builtin", { fg = "{{colors.primary.default.hex}}", italic = true })
vim.api.nvim_set_hl(0, "@constant.builtin", { fg = "{{colors.orange.default.hex}}", bold = true })
vim.api.nvim_set_hl(0, "@string.escape", { fg = "{{colors.primary_fixed_dim.default.hex}}", bold = true })
vim.api.nvim_set_hl(0, "@keyword.return", { fg = "{{colors.error.default.hex}}", italic = true })

-- Telescope: transparent panes — all inherit editor Normal background
local tel = {
    -- Preview panel
    TelescopePreviewNormal  = { bg = "NONE", fg = "{{colors.on_surface.default.hex}}" },
    TelescopePreviewBorder  = { bg = "NONE", fg = "{{colors.outline_variant.default.hex}}" },
    TelescopePreviewTitle   = { bg = "{{colors.tertiary.default.hex}}", fg = "{{colors.on_tertiary.default.hex}}", bold = true },

    -- Results panel
    TelescopeNormal         = { bg = "NONE", fg = "{{colors.on_surface.default.hex}}" },
    TelescopeResultsNormal  = { bg = "NONE", fg = "{{colors.on_surface.default.hex}}" },
    TelescopeResultsBorder  = { bg = "NONE", fg = "{{colors.outline_variant.default.hex}}" },
    TelescopeResultsTitle   = { bg = "NONE", fg = "{{colors.surface.default.hex}}" },

    -- Prompt panel
    TelescopePromptNormal   = { bg = "NONE", fg = "{{colors.on_surface.default.hex}}" },
    TelescopePromptBorder   = { bg = "NONE", fg = "{{colors.outline_variant.default.hex}}" },
    TelescopePromptTitle    = { bg = "{{colors.primary.default.hex}}", fg = "{{colors.on_primary.default.hex}}", bold = true },
    TelescopePromptCounter  = { fg = "{{colors.outline.default.hex}}" },
    TelescopePromptPrefix   = { fg = "{{colors.primary.default.hex}}" },

    -- Selection and matching
    TelescopeSelection      = { bg = "{{colors.primary_container.default.hex}}", fg = "{{colors.on_primary_container.default.hex}}" },
    TelescopeSelectionCaret = { bg = "{{colors.primary_container.default.hex}}", fg = "{{colors.primary.default.hex}}" },
    TelescopeMatching       = { fg = "{{colors.primary.default.hex}}", bold = true },
    TelescopeMultiSelection = { bg = "{{colors.secondary_container.default.hex}}", fg = "{{colors.on_secondary_container.default.hex}}" },
    TelescopeMultiIcon      = { fg = "{{colors.secondary.default.hex}}" },
}
for group, opts in pairs(tel) do
    vim.api.nvim_set_hl(0, group, opts)
end

-- Bufferline highlight overrides
local bl = {
    BufferLineFill          = { bg = "{{colors.surface.default.hex}}" },
    BufferLineBackground    = { bg = "{{colors.surface.default.hex}}", fg = "{{colors.on_surface_variant.default.hex}}" },
    BufferLineTab           = { bg = "{{colors.surface.default.hex}}", fg = "{{colors.on_surface_variant.default.hex}}" },
    BufferLineTabSelected   = { bg = "{{colors.surface_container.default.hex}}", fg = "{{colors.primary.default.hex}}", bold = true },
    BufferLineTabSeparator  = { bg = "{{colors.surface.default.hex}}", fg = "{{colors.surface.default.hex}}" },
    BufferLineTabSeparatorSelected = { bg = "{{colors.surface_container.default.hex}}", fg = "{{colors.surface.default.hex}}" },
    BufferLineBufferSelected = { bg = "{{colors.surface_container.default.hex}}", fg = "{{colors.primary.default.hex}}", bold = true },
    BufferLineCloseButtonSelected = { bg = "{{colors.surface_container.default.hex}}", fg = "{{colors.on_surface.default.hex}}" },
    BufferLineDuplicateSelected = { bg = "{{colors.surface_container.default.hex}}", fg = "{{colors.on_surface_variant.default.hex}}", italic = true },
    BufferLineModified      = { fg = "{{colors.tertiary.default.hex}}" },
    BufferLineModifiedSelected = { bg = "{{colors.surface_container.default.hex}}", fg = "{{colors.tertiary.default.hex}}" },
    BufferLineIndicatorSelected = { fg = "{{colors.primary.default.hex}}" },
    BufferLineSeparator      = { bg = "{{colors.surface.default.hex}}", fg = "{{colors.surface.default.hex}}" },
    BufferLineSeparatorSelected = { bg = "{{colors.surface_container.default.hex}}", fg = "{{colors.surface.default.hex}}" },
}
for group, opts in pairs(bl) do
    vim.api.nvim_set_hl(0, group, opts)
end

-- Sync bufferline's internal highlight state so lazily-created icon highlights
-- inherit the correct bg. Without this, bufferline derives icon bg from its
-- cached config (captured during ColorScheme, before our overrides above).
local bl_ok, bl_config_mod = pcall(require, "bufferline.config")
if bl_ok then
    local cfg = bl_config_mod.get()
    if cfg and cfg.highlights then
        local sc = "{{colors.surface_container.default.hex}}"
        local s = "{{colors.surface.default.hex}}"
        -- Patch parent highlights so future icon derivation uses correct bg
        if cfg.highlights.buffer_selected then cfg.highlights.buffer_selected.bg = sc end
        if cfg.highlights.background then cfg.highlights.background.bg = s end
        if cfg.highlights.buffer_visible then cfg.highlights.buffer_visible.bg = s end
        if cfg.highlights.close_button_selected then cfg.highlights.close_button_selected.bg = sc end
        require("bufferline.highlights").reset_icon_hl_cache()
        -- Fix existing icon highlights directly. Bufferline uses default=true
        -- (themable), so re-creation after cache reset would skip already-defined
        -- groups. This handles hot-reload and between-plugin-load renders.
        local sc_int = tonumber(sc:sub(2), 16)
        local s_int = tonumber(s:sub(2), 16)
        for name, _ in pairs(vim.api.nvim_get_hl(0, {})) do
            if type(name) == "string" and name:match("^BufferLineDevIcon") then
                local val = vim.api.nvim_get_hl(0, { name = name })
                if name:match("Selected$") then val.bg = sc_int
                elseif name:match("Inactive$") then val.bg = s_int
                else val.bg = s_int end
                vim.api.nvim_set_hl(0, name, val)
            end
        end
    end
end

-- Re-source lualine for hot-reload
local ll_ok, lualine = pcall(require, "lualine")
if ll_ok then
    local config = lualine.get_config()
    config.options.theme = "base16"
    lualine.setup(config)
end

-- Redraw tabline so bufferline picks up new highlights
vim.cmd("redrawtabline")
